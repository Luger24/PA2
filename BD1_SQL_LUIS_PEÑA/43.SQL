

SELECT COUNTRY_NAME, CITY, COUNT(DEPARTMENT_ID) DEPTO_MAS_EMPLEADOS
FROM HR.COUNTRIES 
JOIN HR.LOCATIONS USING (COUNTRY_ID) 
JOIN HR.DEPARTMENTS USING (LOCATION_ID) 
WHERE DEPARTMENT_ID IN 
    (SELECT DEPARTMENT_ID FROM HR.EMPLOYEES 
	 GROUP BY DEPARTMENT_ID 
	 HAVING COUNT(DEPARTMENT_ID)>5)
GROUP BY COUNTRY_NAME, CITY;
